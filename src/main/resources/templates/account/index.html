<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">

<head th:replace="fragments :: head"></head>

<nav th:replace="fragments :: navigation"></nav>

<body class="container">

<h1 th:text="${title}">Default Title</h1>

<h1>Account index</h1>
<p>this page should allow you to create and edit accounts</p>
<h1 th:if="${session.user}" th:text="|Hello ${session.user.username}|">Default welcome</h1>

<p th:unless="${userAccounts} and ${userAccounts.size()}">No accounts yet</p>

<div class="well">
    <div class="row">
        <div class="col-md-6" ><h4 th:text="|${{session.user.username}}'s Accounts|"></h4></div>
        <div class="col-md-6"><h4  th:if="${{session.user.userTotal}} >= 0" th:text="|Grand Total = $${#numbers.formatDecimal(session.user.userTotal, 1, 'COMMA', 2, 'POINT')}|"></h4></div>
        <div class="col-md-6"><h4 th:unless="${{session.user.userTotal}} >= 0" th:text="|Grand Total = -$${#numbers.formatDecimal(-session.user.userTotal, 1, 'COMMA', 2, 'POINT')}|"></h4></div>
    </div>
</div>

<a th:href="@{'/account/add'}" class="btn btn-sm btn-primary">Add Account</a>
<p></p>

<table th:if="${userAccounts} and ${userAccounts.size()}" class="table">
    <tr>
        <th class="col-md-6">Account</th>
        <th class="col-md-2">Min</th>
        <th class="col-md-2">Goal</th>
        <th class="col-md-2">Total</th>
    </tr>
    <tr class="list-group" th:if="${userAccounts}" th:each="account : ${userAccounts}">
        <td><a class="list-group-item" th:href="@{'/account/view/' + ${account.id}}" th:text="${{account.name}}"></a></td>
        <td>
            <span th:if="${{account.minimum}} != NULL and (${{account.total}} >= ${{account.minimum}})" th:text="|$${#numbers.formatDecimal(account.minimum, 1, 'COMMA', 2, 'POINT')}|"></span>
            <span th:if="(${{account.minimum}} != NULL) and !(${{account.total}} >= ${{account.minimum}})" th:text="|$${#numbers.formatDecimal(account.minimum, 1, 'COMMA', 2, 'POINT')}|" class="alert alert-danger"></span>
        </td>
        <td>
            <span th:if="${{account.goal}} != NULL and !(${{account.total}} >= ${{account.goal}})" th:text="|$${#numbers.formatDecimal(account.goal, 1, 'COMMA', 2, 'POINT')}|"></span>
            <span th:if="${{account.goal}} != NULL and (${{account.total}} >= ${{account.goal}})" th:text="|$${#numbers.formatDecimal(account.goal, 1, 'COMMA', 2, 'POINT')}|" class="alert alert-success"></span>
        </td>
        <td>
            <strong th:if="${{account.total}} >= 0" th:text="|$${#numbers.formatDecimal(account.total, 1, 'COMMA', 2, 'POINT')}|" ></strong>
            <strong th:if="!(${{account.total}} >= 0)" th:text="|-$${#numbers.formatDecimal(-account.total, 1, 'COMMA', 2, 'POINT')}|"></strong>
        </td>
    </tr>
</table>

</body>
</html>